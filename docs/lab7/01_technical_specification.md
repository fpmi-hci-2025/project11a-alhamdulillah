# Техническое задание

## 1. Общие сведения

**Название проекта**: Махачкала  
**Тип**: Веб-приложение + Мобильное приложение  
**Предметная область**: Сеть ресторанов быстрого питания

## 2. Назначение системы

Система предназначена для автоматизации процесса заказа и доставки шаурмы и других блюд из сети ресторанов "Махачкала" с уникальным предложением "шаурма за 5 рублей".

## 3. Основные функции системы

### 3.1. Для клиентов
- Просмотр меню с фильтрацией и поиском
- Оформление заказа (доставка/самовывоз)
- Отслеживание статуса заказа
- Поиск ближайшего ресторана
- Программа лояльности (бонусы)
- История заказов

### 3.2. Для администраторов
- Управление меню (CRUD операции)
- Просмотр и управление заказами
- Управление акциями и промокодами
- Аналитика продаж

### 3.3. Для курьеров
- Получение заданий на доставку
- Обновление статуса заказа
- Навигация к клиенту

## 4. Требования к системе

### 4.1. Функциональные требования

| ID | Требование | Приоритет |
|----|------------|-----------|
| FR-1 | Регистрация и авторизация пользователей | Критический |
| FR-2 | Просмотр меню с категориями | Критический |
| FR-3 | Добавление товаров в корзину | Критический |
| FR-4 | Оформление заказа | Критический |
| FR-5 | Выбор способа доставки | Критический |
| FR-6 | Онлайн-оплата | Высокий |
| FR-7 | Отслеживание заказа в реальном времени | Высокий |
| FR-8 | Программа лояльности | Средний |
| FR-9 | История заказов | Средний |
| FR-10 | Поиск ресторанов на карте | Высокий |

### 4.2. Нефункциональные требования

**Производительность**:
- Время отклика API: < 200ms (95 перцентиль)
- Загрузка страницы: < 2 сек
- Поддержка 1000+ одновременных пользователей

**Безопасность**:
- HTTPS для всех соединений
- JWT авторизация
- Хеширование паролей (bcrypt)
- Защита от SQL-инъекций
- Rate limiting для API

**Доступность**:
- Uptime: 99.5%
- Graceful degradation при сбоях

**Масштабируемость**:
- Горизонтальное масштабирование backend
- Кеширование (Redis)
- CDN для статики

## 5. Архитектура системы

```
┌─────────────┐     ┌─────────────┐     ┌──────────────┐
│   Web App   │────▶│   Backend   │────▶│  PostgreSQL  │
└─────────────┘     │   (API)     │     └──────────────┘
                    └─────────────┘              │
                          ▲                      │
                          │                      │
┌─────────────┐           │              ┌──────────────┐
│ Mobile App  │───────────┘              │    Redis     │
└─────────────┘                          └──────────────┘
```

## 6. Технологический стек

### Backend
- **Язык**: Python 3.11
- **Framework**: FastAPI
- **БД**: PostgreSQL 15
- **Cache**: Redis
- **ORM**: SQLAlchemy

### Frontend (Web)
- **Framework**: React 18
- **State**: Redux Toolkit
- **UI**: Tailwind CSS
- **Build**: Vite

### Mobile
- **Framework**: React Native
- **State**: Redux Toolkit
- **Navigation**: React Navigation

### DevOps
- **CI/CD**: GitHub Actions
- **Container**: Docker
- **Deploy**: Railway / Vercel

## 7. API Endpoints (базовые)

### Аутентификация
- `POST /api/auth/register` - Регистрация
- `POST /api/auth/login` - Вход
- `POST /api/auth/logout` - Выход

### Меню
- `GET /api/menu` - Список блюд
- `GET /api/menu/:id` - Детали блюда
- `GET /api/categories` - Категории

### Заказы
- `POST /api/orders` - Создать заказ
- `GET /api/orders` - Список заказов пользователя
- `GET /api/orders/:id` - Детали заказа
- `PATCH /api/orders/:id/status` - Обновить статус

### Корзина
- `GET /api/cart` - Получить корзину
- `POST /api/cart/items` - Добавить в корзину
- `DELETE /api/cart/items/:id` - Удалить из корзины

### Рестораны
- `GET /api/restaurants` - Список ресторанов
- `GET /api/restaurants/nearby` - Ближайшие рестораны

## 8. Модель данных (основные сущности)

### User
```
- id: UUID
- email: String
- phone: String
- password_hash: String
- name: String
- created_at: DateTime
```

### MenuItem
```
- id: UUID
- name: String
- description: Text
- price: Decimal
- category_id: UUID
- image_url: String
- is_available: Boolean
```

### Order
```
- id: UUID
- user_id: UUID
- restaurant_id: UUID
- total: Decimal
- status: Enum
- delivery_type: Enum
- address: String
- created_at: DateTime
```

### OrderItem
```
- id: UUID
- order_id: UUID
- menu_item_id: UUID
- quantity: Integer
- price: Decimal
```

## 9. Этапы разработки

### Sprint 1 (2 недели)
- Настройка проекта и репозиториев
- Backend: базовые модели и API для меню
- Frontend: главная страница и список меню

### Sprint 2 (2 недели)
- Backend: корзина и заказы
- Frontend: корзина и оформление заказа
- Mobile: главный экран и меню

### Sprint 3 (2 недели)
- Backend: аутентификация и профиль
- Frontend: регистрация и профиль
- Mobile: корзина и заказы

### Sprint 4 (1 неделя)
- Интеграция и тестирование
- Деплой
- Документация

## 10. Критерии приемки

- ✅ Все API endpoints работают согласно спецификации
- ✅ Frontend отображает данные из API
- ✅ Можно создать заказ от начала до конца
- ✅ Покрытие тестами > 70%
- ✅ Нет критических багов
- ✅ Проходит код-ревью
- ✅ Документация API актуальна

## Ссылки

- [Распределение задач](02_task_distribution.md)
- [OpenAPI спецификация](../openapi-spec/openapi.yaml)
- [Диаграммы](../diagrams/)
